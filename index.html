<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>AR Parabola Markerless</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <style>
    body { margin:0; font-family:sans-serif; }
    #controls {
      position: fixed;
      top: 10px; left: 10px;
      background: rgba(255,255,255,0.9);
      padding: 10px; border-radius: 8px;
      z-index: 999;
      width: 220px;
    }
    #controls label { display:block; margin-top:5px; font-size:14px; }
    #controls input { width:100%; }
  </style>
</head>
<body>

<div id="controls">
  <label>Kecepatan awal (m/s): <span id="v0Val">3</span></label>
  <input type="range" id="v0" min="1" max="10" step="0.1" value="3">

  <label>Sudut peluncuran (°): <span id="angleVal">60</span></label>
  <input type="range" id="angle" min="10" max="80" step="1" value="60">

  <label>Gravitasi (m/s²): <span id="gVal">9.8</span></label>
  <input type="range" id="g" min="1" max="20" step="0.1" value="9.8">

  <button id="resetBtn">Reset Simulasi</button>
  
  <p id="stats"></p>
</div>

<!-- Model-viewer AR -->
<model-viewer id="modelViewer"
  src="ball.glb"
  ar
  ar-modes="webxr scene-viewer quick-look"
  camera-controls
  auto-rotate
  shadow-intensity="1"
  style="width:100vw; height:100vh;">
</model-viewer>

<script>
  // Parameter default
  let v0 = 3, angle = 60, g = 9.8;
  let t = 0, dt = 0.05;

  const resetBtn = document.getElementById('resetBtn');
  const stats = document.getElementById('stats');
  const v0Slider = document.getElementById('v0');
  const angleSlider = document.getElementById('angle');
  const gSlider = document.getElementById('g');
  const v0Val = document.getElementById('v0Val');
  const angleVal = document.getElementById('angleVal');
  const gVal = document.getElementById('gVal');

  function resetSimulation() {
    t = 0;
    updateStats();
  }

  resetBtn.addEventListener('click', resetSimulation);

  v0Slider.addEventListener('input', () => { v0=parseFloat(v0Slider.value); v0Val.innerText=v0; resetSimulation(); });
  angleSlider.addEventListener('input', () => { angle=parseFloat(angleSlider.value); angleVal.innerText=angle; resetSimulation(); });
  gSlider.addEventListener('input', () => { g=parseFloat(gSlider.value); gVal.innerText=g; resetSimulation(); });

  function updateStats() {
    let rad = angle * Math.PI / 180;
    let t_max = (2*v0*Math.sin(rad))/g;
    let x_max = v0*Math.cos(rad)*t_max;
    let y_max = (v0*Math.sin(rad))**2/(2*g);
    stats.innerHTML = `Tinggi maksimum: ${y_max.toFixed(2)} m<br>Jangkauan: ${x_max.toFixed(2)} m`;
  }

  function update() {
    t += dt;
    let rad = angle*Math.PI/180;
    let x = v0*Math.cos(rad)*t;
    let y = v0*Math.sin(rad)*t - 0.5*g*t*t;
    if(y<0){ t=0; return; }
    // Update posisi model-viewer (markerless AR) menggunakan translate
    const model = document.querySelector('model-viewer');
    model.style.transform = `translate3d(${x}px, ${-y*50}px, 0)`; // perkiraan scaling visual
    updateStats();
  }

  setInterval(update, dt*1000);
  resetSimulation();
</script>

</body>
</html>
